# Copyright 2019 Heiko Schaefer heiko@schaefer.name
#
# This file is part of OpenPGP CA.
#
# OpenPGP CA is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# OpenPGP CA is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with OpenPGP CA.  If not, see <https://www.gnu.org/licenses/>.

name: openpgp-ca
author: Heiko Sch√§fer <heiko@schaefer.name>
about: openpgp-ca is a tool to manage OpenPGP setups
settings:
  - ArgRequiredElseHelp
args:
  - database:
      short: d
      long: database
      value_name: FILE
      help: Sets a custom sqlite file
      takes_value: true
subcommands:
  - init:
      about: Initialize OpenPGP CA
  - ca:
      about: Manage CA
      subcommands:
        - new:
            about: Create CA
            args:
              - domain:
                  takes_value: true
                  help: CA domain name
        - show:
            about: Show CA
        - export:
            about: Export CA public key
        - import-tsig:
            about: Import trust signature for CA Key
            args:
              - key-file:
                  takes_value: true
                  required: true
                  short: f
                  long: file
                  help: File that contains the tsigned CA Key

  - user:
      about: Manage Users
      subcommands:
        - add:
            about: Add User (create new Key-Pair)
            args:
              - email:
                  takes_value: true
                  short: e
                  long: email
                  multiple: true
                  help: Email address
              - name:
                  takes_value: true
                  short: n
                  long: name
                  help: User Name
        #              - key-profile:
        #                  takes_value: true
        #                  long: key-profile
        #                  help: Key Profile
        - import:
            about: Import User (use existing Public Key)
            args:
              - email:
                  takes_value: true
                  short: e
                  long: email
                  multiple: true
                  help: Email address
              - name:
                  takes_value: true
                  short: n
                  long: name
                  help: User Name
              - key-file:
                  takes_value: true
                  long: key-file
                  help: File that contains the User's Public Key
              - revocation-file:
                  takes_value: true
                  short: r
                  long: revocation-file
                  help: File that contains the User's revocation cert
        - export:
            about: Export User Public Key (bulk, if no email address is given)
            args:
              - email:
                  takes_value: true
                  short: e
                  long: email
                  help: Email address
        - revocation:
            about: Show Revocation Key (if available)
            args:
              - email:
                  takes_value: true
                  short: e
                  required: true
                  multiple: false
                  long: email
                  help: Email address
        - add-revocation:
            about: Add Revocation Certificate
            args:
              - revocation-file:
                  takes_value: true
                  short: r
                  long: revocation-file
                  required: true
                  multiple: false
                  help: File that contains a revocation cert
        - check:
            about: Bulk checks on Users
            subcommands:
              - sigs:
                  about: Check signatures and trust signatures on CA key
              - expiry:
                  about: Check user key expiry
                  args:
                    - days:
                        takes_value: true
                        short: d
                        long: days
                        required: false
                        multiple: false
                        help: Check for keys that expire within "days" days
        - list:
            about: List Users
  - bridge:
      about: Manage Bridges
      subcommands:
        - new:
            about: Add New Bridge (sign existing remote CA Public Key)
            args:
              - email:
                  takes_value: true
                  short: e
                  long: email
                  help: Bridge remote Email
              - scope:
                  required: false
                  takes_value: true
                  short: s
                  long: scope
                  help: Scope for trust of this bridge (domainname)
              - remote-key-file:
                  long: remote-key-file
                  takes_value: true
                  required: true
                  help: File that contains the remote CA's Public Key
        - revoke:
            about: Revoke Bridge
            args:
              - name:
                  required: true
                  takes_value: true
                  short: n
                  long: email
                  help: Bridge remote Email
        - list:
            about: List Bridges
  - directory:
      about: Manage Directories
      subcommands:
        - add:
            about: Add Directory
        - delete:
            about: Delete Directory from CA
  - wkd-export:
      about: Export all Certs to WKD
      args:
        - path:
            takes_value: true
            help: Filesystem directory for WKD export
  - key-profile:
      about: Manage key-profiles
      subcommands:
        - add:
            about: Add key-profile
        - delete:
            about: Delete key-profile