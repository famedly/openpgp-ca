This example shows how the OpenPGP CA admin can create keys on behalf of
their users. We call this workflow "centralized key creation", because
OpenPGP keys get created centrally by the OpenPGP CA admin.

This workflow is very streamlined, both for the admin and for users.
However, creating the user key on the admin's machine is a tradeoff which
is not ideal for every use case.

For example, in some organizations, the CA admin may want to avoid ever
having access to users' private key material, so they can never be coerced
into hading those keys over to a third party.

## Part 1: Tasks on the OpenPGP CA admin machine

### Set up OpenPGP CA instance 

To start, if we don't already have instance of OpenPGP CA, we set up a
new one. An OpenPGP CA instance consists of a single file - an SQLite
database in which all state is kept.

Set environment variable to configure where the database is stored:
 
`$ export OPENPGP_CA_DB=/tmp/openpgp-ca.sqlite`

Initialize a new CA instance for the domain `example.org` and generate a new
keypair for the OpenPGP CA admin:

`$ openpgp-ca ca init example.org` 

The OpenPGP CA admin uses the email address `openpgp-ca@example.org` by
convention.

### Create a new user

`$ openpgp-ca user add --email alice@example.org --name "Alice Adams"`

The new user's private Key is shown as output of this command, but not
stored. It needs to be copied to the user's devices and imported into the
OpenPGP keystore there. We're going to paste the key into a file
`alice.privatekey` for this example.

### Export the OpenPGP CA public key

Then we export the CA public key, for use on client machines.
For example, Alice needs a copy of the CA admin's public key.

`$ openpgp-ca ca export > ca.pubkey` 

The key is already tsigned by Alice at this point, because Alice's key was
generated by OpenPGP CA - in this workflow, OpenPGP CA has temporary access
to Alice's private key material, and uses it to certify the CA admin key.

## Part 2: Tasks on user's machine (using GnuPG)

In this example, we imagine that Alice is using GnuPG on her machine. She
now wants to import the public key of the CA admin, as well as her own new
key (that was generated by the OpenPGP CA admin, above).
 

### First, we set up a GnuPG test environment:

`$ mkdir /tmp/test/`

`$ export GNUPGHOME=/tmp/test/`

### Then we import Alice's private key

`$ gpg --import alice.privatekey`

Alice sets ownertrust for this key, which she considers her own key:

`$ gpg --edit-key alice@example.org`

Then enter `trust`, `5`, `quit`.

### Then Alice imports the CA admin's public key

`$ gpg --import ca.pubkey`

### Check the result

Now we can verify that gpg shows the Alice's key with "ultimate" trust, and
the CA admin key with "full" trust:
 
`$ gpg --list-keys` 
